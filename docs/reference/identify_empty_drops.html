<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify empty droplets — identify_empty_drops • DropletQC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Identify empty droplets — identify_empty_drops" />
<meta property="og:description" content="This function is used to identify a suitable nuclear fraction
cut-off point to guide the identification of empty droplets. To do this it
calculates the kernel density estimate of the input nuclear fraction scores
and identifies the trough after the first peak, which is assumed to
represent the population of empty droplets." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DropletQC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/DropletQC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/WalterMuskovic/DropletQC/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify empty droplets</h1>
    <small class="dont-index">Source: <a href='https://github.com/WalterMuskovic/DropletQC/blob/master/R/identify_empty_drops.R'><code>R/identify_empty_drops.R</code></a></small>
    <div class="hidden name"><code>identify_empty_drops.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is used to identify a suitable nuclear fraction
cut-off point to guide the identification of empty droplets. To do this it
calculates the kernel density estimate of the input nuclear fraction scores
and identifies the trough after the first peak, which is assumed to
represent the population of empty droplets.</p>
    </div>

    <pre class="usage"><span class='fu'>identify_empty_drops</span><span class='op'>(</span>
  <span class='va'>nf_umi</span>,
  nf_rescue <span class='op'>=</span> <span class='fl'>0.05</span>,
  umi_rescue <span class='op'>=</span> <span class='fl'>1000</span>,
  include_plot <span class='op'>=</span> <span class='cn'>FALSE</span>,
  plot_name <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot_path <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot_width <span class='op'>=</span> <span class='fl'>18</span>,
  plot_height <span class='op'>=</span> <span class='fl'>13</span>,
  pdf_png <span class='op'>=</span> <span class='st'>"png"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nf_umi</th>
      <td><p>data frame, containing two columns; the nuclear fraction
estimates in the first column and the total UMI count for each barcode in
the second column</p></td>
    </tr>
    <tr>
      <th>nf_rescue</th>
      <td><p>numeric, a rescue parameter defining a minimum nuclear
fraction score between zero and one. This is used in combination with
<code>umi_rescue</code> to identify cells that were misidentified as empty droplets</p></td>
    </tr>
    <tr>
      <th>umi_rescue</th>
      <td><p>integer, a rescue parameter defining a minimum UMI count.
This is used in combination with <code>nf_rescue</code> to identify cells that were
misidentified as empty droplets</p></td>
    </tr>
    <tr>
      <th>include_plot</th>
      <td><p>logical, whether or not to produce a plot illustrating
how the nuclear fraction threshold was identified and which barcodes have
been called as empty droplets. In the plot of nuclear fraction vs log10(UMI
counts), empty droplets are expected to occupy the lower left corner of the
plot.</p></td>
    </tr>
    <tr>
      <th>plot_name</th>
      <td><p>character, if provided a plot will be saved with the
provided name</p></td>
    </tr>
    <tr>
      <th>plot_path</th>
      <td><p>character, if provided a plot will be saved to the provided
path</p></td>
    </tr>
    <tr>
      <th>plot_width</th>
      <td><p>numeric, plot width in cm</p></td>
    </tr>
    <tr>
      <th>plot_height</th>
      <td><p>numeric, plot height in cm</p></td>
    </tr>
    <tr>
      <th>pdf_png</th>
      <td><p>character, either "png" or "pdf"</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data frame, the original data frame is returned plus an additional
column identifying each barcode as a "cell" or "empty_droplet"</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"qc_examples"</span><span class='op'>)</span>
<span class='va'>gbm</span> <span class='op'>&lt;-</span> <span class='va'>qc_examples</span><span class='op'>[</span><span class='va'>qc_examples</span><span class='op'>$</span><span class='va'>sample</span><span class='op'>==</span><span class='st'>"GBM"</span>,<span class='op'>]</span>
<span class='va'>gbm.ed</span> <span class='op'>&lt;-</span> <span class='va'>gbm</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"nuclear_fraction_droplet_qc"</span>,<span class='st'>"umi_count"</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>gbm.ed</span> <span class='op'>&lt;-</span> <span class='fu'>identify_empty_drops</span><span class='op'>(</span>nf_umi <span class='op'>=</span> <span class='va'>gbm.ed</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>gbm.ed</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                    nuclear_fraction_droplet_qc umi_count cell_status
#&gt; AAACCCAAGGCGATAC-1                   0.1947243      2226        cell
#&gt; AAACCCAAGGCTGTAG-1                   0.2766798      1063        cell
#&gt; AAACCCACAAGTCCCG-1                   0.1843824     17883        cell
#&gt; AAACCCACAGATGCGA-1                   0.2919902      8172        cell
#&gt; AAACCCACAGGTGAGT-1                   0.3295617      9057        cell
#&gt; AAACCCAGTCTTGCGG-1                   0.3795893      5612        cell</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>gbm.ed</span><span class='op'>$</span><span class='va'>cell_status</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;          cell empty_droplet 
#&gt;          5296           220 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Walter Muskovic.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


