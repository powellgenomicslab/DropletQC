<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the nuclear fraction statistic using BAM tags — nuclear_fraction_tags • DropletQC</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate the nuclear fraction statistic using BAM tags — nuclear_fraction_tags" />
<meta property="og:description" content="This function uses the region type tags in a provided BAM file to
calculate for each input cell barcode the nuclear fraction statistic. This
is just the fraction of reads that are intronic:
nuclear fraction = # intronic reads / (# intronic reads + # of exonic reads)
The row names of the returned data frame will match the order and name of
the supplied barcodes. As a minimum you can provide as input a directory
containing cellranger output (outs)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DropletQC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/DropletQC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the nuclear fraction statistic using BAM tags</h1>
    
    <div class="hidden name"><code>nuclear_fraction_tags.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses the region type tags in a provided BAM file to
calculate for each input cell barcode the nuclear fraction statistic. This
is just the fraction of reads that are intronic:</p>
<p>nuclear fraction = # intronic reads / (# intronic reads + # of exonic reads)</p>
<p>The row names of the returned data frame will match the order and name of
the supplied barcodes. As a minimum you can provide as input a directory
containing cellranger output (outs).</p>
    </div>

    <pre class="usage"><span class='fu'>nuclear_fraction_tags</span><span class='op'>(</span>
  outs <span class='op'>=</span> <span class='cn'>NULL</span>,
  bam <span class='op'>=</span> <span class='cn'>NULL</span>,
  bam_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>bam</span>, <span class='st'>".bai"</span><span class='op'>)</span>,
  barcodes <span class='op'>=</span> <span class='cn'>NULL</span>,
  cores <span class='op'>=</span> <span class='fu'>future</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/future/man/re-exports.html'>availableCores</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>,
  tiles <span class='op'>=</span> <span class='fl'>100</span>,
  cell_barcode_tag <span class='op'>=</span> <span class='st'>"CB"</span>,
  region_type_tag <span class='op'>=</span> <span class='st'>"RE"</span>,
  exon_tag <span class='op'>=</span> <span class='st'>"E"</span>,
  intron_tag <span class='op'>=</span> <span class='st'>"N"</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>outs</th>
      <td><p>character, the path to the 'outs' directory created by Cell
Ranger. We assume outs is structured this way:</p>
<p>├── filtered_feature_bc_matrix</p>
<p>│   ├── barcodes.tsv.gz</p>
<p>│   ├── features.tsv.gz</p>
<p>│   └── matrix.mtx.gz</p>
<p>├── possorted_genome_bam.bam</p>
<p>├── possorted_genome_bam.bam.bai</p>
<p>├── raw_feature_bc_matrix</p>
<p>│   ├── barcodes.tsv.gz</p>
<p>│   ├── features.tsv.gz</p>
<p>│   └── matrix.mtx.gz</p>
<p>Note that there will probably be other files in the directory as well. We
don't need to worry about those, as the only three files that the function
will require are; possorted_genome_bam.bam, possorted_genome_bam.bam.bai and
filtered_feature_bc_matrix/barcodes.tsv.gz. This is the only required
argument for the function. If your directory structure doesn't match the one
created by Cell Ranger you can provide the file paths directly using the
bam, bam_index and barcodes arguments.</p></td>
    </tr>
    <tr>
      <th>bam</th>
      <td><p>character, the path to the input bam file. Not required if an
'outs' directory is provided.</p></td>
    </tr>
    <tr>
      <th>bam_index</th>
      <td><p>character, the path to the input bam file index. Not required
if an 'outs' directory is provided.</p></td>
    </tr>
    <tr>
      <th>barcodes</th>
      <td><p>character, either a vector of barcode names or the path to the
barcodes.tsv.gz file output by Cell Ranger. If providing the cell barcodes
as a vector, make sure that the format matches the one in the BAM file -
e.g. be mindful if there are integers appended to the end of the barcode
sequence. This argument isn't required if an 'outs' directory is provided -
the function will just look for "barcodes.tsv.gz" in
outs/filtered_feature_bc_matrix.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>numeric, runs the function in parallel using furrr:future_map()
with the requested number of cores. Setting <code>cores=1</code> will cause future_map
to run sequentially.</p></td>
    </tr>
    <tr>
      <th>tiles</th>
      <td><p>numeric, to speed up the processing of the BAM file we can split
the genome up into tiles and process reads in chunks</p></td>
    </tr>
    <tr>
      <th>cell_barcode_tag</th>
      <td><p>character, the BAM tag containing the cell barcode
sequence</p></td>
    </tr>
    <tr>
      <th>region_type_tag</th>
      <td><p>character, the BAM tag containing the region type</p></td>
    </tr>
    <tr>
      <th>exon_tag</th>
      <td><p>character, the character string that defines a read as exonic</p></td>
    </tr>
    <tr>
      <th>intron_tag</th>
      <td><p>character, the character string that defines a read as
intronic</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical, whether or not to print progress</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data.frame, the function returns a 1-column data frame containing the
calculated nuclear fraction statistic for each input barcode. The order and
names of the rows will match those of the input cell barcodes.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>nf1</span> <span class='op'>&lt;-</span> <span class='fu'>nuclear_fraction_tags</span><span class='op'>(</span>
    outs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"outs"</span>, package <span class='op'>=</span>
    <span class='st'>"DropletQC"</span><span class='op'>)</span>,
     tiles <span class='op'>=</span> <span class='fl'>1</span>, cores <span class='op'>=</span> <span class='fl'>1</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>nf1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                    nuclear_fraction
#&gt; AAAAGTCACTTACTTG-1        0.9032698
#&gt; AAAAGTGGATCTCTAA-1        0.4032761
#&gt; AAAGCAGTTACGAAGA-1        0.3957704
#&gt; AACGACTTCAATATGT-1        0.4004525
#&gt; AACGGCGTCATCTGGA-1        0.8845109
#&gt; AAGCAGGGGTCGCGAA-1        0.3929376</div><div class='input'>
<span class='va'>nf2</span> <span class='op'>&lt;-</span> <span class='fu'>nuclear_fraction_tags</span><span class='op'>(</span>
   bam <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"outs"</span>,<span class='st'>"possorted_genome_bam.bam"</span>, package <span class='op'>=</span>
   <span class='st'>"DropletQC"</span><span class='op'>)</span>,
   barcodes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"AAAAGTCACTTACTTG-1"</span>,
                <span class='st'>"AAAAGTGGATCTCTAA-1"</span>,
                <span class='st'>"AAACACGTTCTCATCG-1"</span><span class='op'>)</span>,
   tiles <span class='op'>=</span> <span class='fl'>1</span>, cores <span class='op'>=</span> <span class='fl'>1</span>,
   verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>nf2</span>
</div><div class='output co'>#&gt;                    nuclear_fraction
#&gt; AAAAGTCACTTACTTG-1        0.9032698
#&gt; AAAAGTGGATCTCTAA-1        0.4032761
#&gt; AAACACGTTCTCATCG-1        0.0000000</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Walter Muskovic.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


